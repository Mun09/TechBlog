# 15장: Testing

**Spring 테스트 기법 2가지**

1. 단위 테스트(Unit Test) 특정 메서드의 논리를 검증하는 테스트 빠르게 실행되며, 짧고 간결한 코드로 작성 의존성을 제거하고 특정 기능만 검증
2. Spring 통합 테스트(Integration Test) 특정 메서드의 논리뿐만 아니라 Spring 프레임워크와의 통합까지 검증 예를 들어, Spring의 데이터베이스 연동 기능이 올바르게 동작하는지 확인 의존성을 포함한 전체 기능이 정상적으로 작동하는지 테스트

**단위 테스트란?** \
특정 유즈 케이스를 특정 조건에서 실행하고, 기대하는 동작을 검증하는 메서드 애플리케이션의 요구사항에 맞게 동작하는지 확인 의존성을 모두 제거하여 특정 로직만 독립적으로 검증

단위테스트는 세 가지 주요 부분으로 구성된다.

1. 가정 테스트할 로직이 특정 방식으로 동작하도록 입력값과 의존성을 정의
2. 실행 테스트할 메서드를 실행
3. 검증 기대한 대로 동작하는지 검증

유즈 케이스를 테스트할 때 해당 메서드가 생성하지 않는 외부 객체는 모두 의존성이다. 단위 테스트는 특정 로직만 검증해야 하므로 외부 객체를 테스트하지 못한다. 이를 위해서 가짜 객체(Mock)를 만들어서 특정 동작을 유도한다.

@Mock로 가짜객체임을 알리면 @InjectMock 주석의 객체는 @Mock가 붙은 객체들을 주입당한다. 이를 위해서 테스트 클래스위에 @ExtendWith 주석을 붙여야 한다. 이뤄져야하는 흐름은 given-willReturn를 이용해서 결과를 명령할 수 있다. 예외 흐름은 assertThrows로 검증. verify로 예상된 결과를 검증.

**통합테스트란?** \
유닛테스트와 매우 유사하다. 여전히 JUnit을 사용하여 테스트를 작성하지만, 유닛 테스트는 특정 컴포넌트의 동작에 집중하는 반면, 통합 테스트는 두 개 이상의 컴포넌트가 어떻게 상호작용하는지에 초점을 맞춥니다. 앱에서는 각각의 컴포넌트가 독립적으로 잘 작동하더라도 서로 올바르게 "대화"하지 않는 경우가 있을 수 있다. 통합테스트는 이런 문제를 예방하는데 도움을 준다.

**어떤 통합을 테스트하는가?**

1. 앱의 두 개 이상의 객체 간의 통합
2. 앱 객체와 프레임워크가 제공하는 기능과의 통합
3. 앱과 데이터베이스 간의 통합

통합 테스트의 구성 유닛테스트와 유사하게 구성된다.

1. 가정
2. 메소드 호출
3. 검증

유닛테스트에서는 보통 모든 컴포넌트를 모킹하지만, 통합테스트에서는 일부 컴포넌트는 실제 객체를 사용해도 된다. @MockBean을 사용하면 Spring Boot 애플리케이션에서 mock 객체를 생성하고 이를 애플리케이션 컨텍스트에 추가할 수 있다. 이 방식은 객체의 실제 동작을 검증하면서 Spring이 관리하는 객체들과의 상호작용도 확인할 수 있게 한다.
